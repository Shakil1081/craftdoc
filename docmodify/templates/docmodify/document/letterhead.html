{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="{% static 'css/lh_style.css' %}" />

    {% for font in fonts %}
      <link rel="stylesheet" href="{{ font.url }}" />
    {% endfor %}

    <title>Document</title>
  </head>

  <body>
    {% load custom_filters %}
    <div id="letterhead-body">
      <div class="left-panel">
        <div class="row row-cols-2 g-2 letterhead-items">
          {% for singleDocument in documents %}
            {% with img=images_by_document|get_item:singleDocument.id %}
              <div class="letterhead-item {% if forloop.first %}selected{% endif %}" data-document-id="{{ singleDocument.id }}" data-header="{{ img.header }}" data-footer="{{ img.footer }}" data-phone="{{ singleDocument.phone|default:'' }}" data-email="{{ singleDocument.email|default:'' }}" data-location="{{ singleDocument.location|default:'' }}">
                <img class="preview-image" src="{{ singleDocument.file_path.url }}" alt="Template {{ forloop.counter }}" />
              </div>
            {% endwith %}
          {% endfor %}
        </div>
      </div>

      <div class="content-panel">
        <div class="zoom-buttons">
          <div class="input-group input-group-sm">
            <button id="zoomOutBtn" class="input-group-text">-</button>
            <div id="zoomInput" class="form-control text-center">100%</div>
            <button id="zoomInBtn" class="input-group-text">+</button>
          </div>
        </div>
        <div class="content">
          <div id="a4panel">
            <div id="logo">
              <img id="logoPreview" src="{% static 'img/logo.jpg' %}" alt="Logo" />
            </div>
            <div id="contactShow">01736234377 01916120927</div>
            <div id="emailShow">admin@gmail.com mail@example.com</div>
            <div id="locationShow">123, Main Street, Dhaka, Bangladesh.</div>
          </div>
        </div>
      </div>

      <div class="right-panel">
        <!-- Download Buttons -->
        <div class="d-flex align-items-center mb-3 gap-3">
          <h5 class="m-0">Download</h5>
          <div class="btn-group btn-group-sm">
            <button class="btn btn-outline-danger">PDF</button>
            <button class="btn btn-outline-secondary">PNG</button>
            <button class="btn btn-outline-success">JPG</button>
          </div>
        </div>

        <!-- Logo Change -->
        <div class="logo-change-panel">
          <h5>Logo</h5>
          <div class="logo-panel">
            <img id="logoPreview" class="logo" src="{% static 'img/logo.jpg' %}" alt="Logo Preview" />
            <label for="logoInput" class="change-logo">Change</label>
          </div>
          <input type="file" hidden id="logoInput" class="form-control" accept="image/*" />
        </div>

        <hr />

        <!-- Text Areas -->
        <div class="single-content-panel">
          <h5 class="title">Phone</h5>
          <textarea id="phoneField" rows="2" class="form-control form-control-sm"></textarea>
        </div>

        <div class="single-content-panel">
          <h5 class="title">Email</h5>
          <textarea id="emailField" rows="2" class="form-control form-control-sm"></textarea>
        </div>

        <div class="single-content-panel">
          <h5 class="title">Location</h5>
          <textarea id="locationField" rows="2" class="form-control form-control-sm"></textarea>
        </div>

        <!-- Header Select -->
        <div class="single-content-panel header">
          <h5 class="title">Header</h5>
          <div id="headerChangePanel">
            {% for hf in header_footer_images %}
              {% if hf.header %}
                <div class="header-item {% if forloop.first %}selected{% endif %}" data-hf-id="{{ hf.id }}" data-header="{{ hf.header.url }}">
                  <img class="header-item-img" src="{{ hf.header.url }}" alt="Header {{ forloop.counter }}" />
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>

        <!-- Footer Select -->
        <div class="single-content-panel footer">
          <h5 class="title">Footer</h5>
          <div id="footerChangePanel">
            {% for hf in header_footer_images %}
              {% if hf.footer %}
                <div class="footer-item {% if forloop.first %}selected{% endif %}" data-hf-id="{{ hf.id }}" data-footer="{{ hf.footer.url }}">
                  <img class="footer-item-img" src="{{ hf.footer.url }}" alt="Footer {{ forloop.counter }}" />
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/lh_custom.js' %}"></script>
    <script>
      $(document).ready(function () {
        $('.letterhead-item').on('click', function () {
          $('.letterhead-item').removeClass('selected')
          $(this).addClass('selected')
      
          const header = $(this).data('header')
          const footer = $(this).data('footer')
          const phone = $(this).data('phone') || ''
          const email = $(this).data('email') || ''
          const location = $(this).data('location') || ''
      
          // Select header
          $('#headerChangePanel .header-item').removeClass('selected').filter(`[data-header="${header}"]`).addClass('selected')
      
          // Select footer
          $('#footerChangePanel .footer-item').removeClass('selected').filter(`[data-footer="${footer}"]`).addClass('selected')
      
          // Update text fields
          $('#contactShow').text(phone)
          $('#emailShow').text(email)
          $('#locationShow').text(location)
          $('#phoneField').val(phone)
          $('#emailField').val(email)
          $('#locationField').val(location)
        })
      
        // Trigger default selection
        $('.letterhead-item').first().trigger('click')
      })
    </script>
  </body>
</html>
